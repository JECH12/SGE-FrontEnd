import{a as O,b as s,c as R,d as w,e as G,f as T,g as j,h as q,i as k,j as B,k as L,l as P,m as $}from"./chunk-S53VDARQ.js";import{a as A,b as M}from"./chunk-Y3EZDKBL.js";import{a as V}from"./chunk-TLIOSQLB.js";import{$ as _,A as l,B as y,F as d,H as a,J as o,K as t,L as c,M as S,N as E,O as u,P as r,Q as f,T as h,aa as x,da as C,ha as I,ja as N,ka as F,na as D,s as g,t as b,y as m}from"./chunk-R54EMC5Q.js";var H=()=>["/employees"];function J(n,e){n&1&&(o(0,"div",7),r(1," Cargando datos... "),t())}function K(n,e){if(n&1&&(o(0,"option",20),r(1),t()),n&2){let i=e.$implicit;a("value",i.id),m(),f(i.name)}}function Q(n,e){if(n&1&&(o(0,"option",20),r(1),t()),n&2){let i=e.$implicit;a("value",i.id),m(),f(i.name)}}function U(n,e){if(n&1){let i=S();o(0,"form",8),E("ngSubmit",function(){g(i);let v=u();return b(v.submit())}),o(1,"div",9)(2,"label",10),r(3,"Nombre completo"),t(),c(4,"input",11),t(),o(5,"div",9)(6,"label",10),r(7,"Fecha de contrataci\xF3n"),t(),c(8,"input",12),t(),o(9,"div",9)(10,"label",10),r(11,"Salario"),t(),c(12,"input",13),t(),o(13,"div",9)(14,"label",10),r(15,"Departamento"),t(),o(16,"select",14)(17,"option",15),r(18,"Seleccione..."),t(),d(19,K,2,2,"option",16),t()(),o(20,"div",17)(21,"label",10),r(22,"Cargo"),t(),o(23,"select",18)(24,"option",15),r(25,"Seleccione..."),t(),d(26,Q,2,2,"option",16),t()(),o(27,"button",19),r(28," Guardar cambios "),t()()}if(n&2){let i=u();a("formGroup",i.form),m(19),a("ngForOf",i.departments),m(7),a("ngForOf",i.positions),m(),a("disabled",i.loading)}}var z=class n{constructor(e,i,p,v,W,X){this.fb=e;this.route=i;this.router=p;this.employeesService=v;this.departmentsService=W;this.positionsService=X;this.form=this.fb.nonNullable.group({fullName:["",[s.required,s.minLength(3)]],hireDate:["",s.required],salary:[0,s.required],departmentId:[0,s.required],positionId:[0,s.required]})}id;loading=!1;errorMessage="";departments=[];positions=[];form;ngOnInit(){this.id=Number(this.route.snapshot.paramMap.get("id")),this.loadData()}loadData(){this.loading=!0,this.departmentsService.getAll().subscribe(e=>this.departments=e.data||[]),this.positionsService.getAll().subscribe(e=>this.positions=e.data||[]),this.employeesService.getById(this.id).subscribe({next:e=>{e.data&&this.form.patchValue({fullName:e.data.fullName,hireDate:e.data.hireDate.substring(0,10),salary:e.data.salary,departmentId:e.data.departmentId,positionId:e.data.positionId}),this.loading=!1},error:()=>{this.errorMessage="No se pudo cargar la informaci\xF3n",this.loading=!1}})}submit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.loading=!0,this.employeesService.update(this.id,this.form.value).subscribe({next:()=>{this.router.navigate(["/employees"])},error:()=>{this.errorMessage="Error al actualizar el empleado",this.loading=!1}})}static \u0275fac=function(i){return new(i||n)(l(P),l(I),l(N),l(V),l(A),l(M))};static \u0275cmp=y({type:n,selectors:[["app-employees-edit"]],decls:9,vars:4,consts:[[1,"container","mt-5"],[1,"card","shadow-lg","p-4","border-0"],[1,"mb-4","text-primary"],["class","alert alert-info",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"mt-3"],[1,"btn","btn-outline-secondary","w-100",3,"routerLink"],[1,"alert","alert-info"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-semibold"],["type","text","formControlName","fullName",1,"form-control","form-control-lg"],["type","date","formControlName","hireDate",1,"form-control","form-control-lg"],["type","number","formControlName","salary",1,"form-control","form-control-lg"],["formControlName","departmentId",1,"form-select","form-select-lg"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"mb-4"],["formControlName","positionId",1,"form-select","form-select-lg"],[1,"btn","btn-success","btn-lg","w-100",3,"disabled"],[3,"value"]],template:function(i,p){i&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Editar Empleado"),t(),d(4,J,2,0,"div",3)(5,U,29,4,"form",4),o(6,"div",5)(7,"button",6),r(8," \u2190 Volver al listado "),t()()()()),i&2&&(m(4),a("ngIf",p.loading),m(),a("ngIf",!p.loading),m(2),a("routerLink",h(3,H)))},dependencies:[$,G,B,L,O,T,k,R,w,j,q,C,_,x,D,F],encapsulation:2})};export{z as EmployeesEditComponent};
